apply plugin: 'java'

import org.ajoberstar.grgit.*

//TODO:  Add support for WhisperSystems gradle-witness plugin for dependency verification
buildscript {
    repositories {
        mavenCentral()
    }

    dependencies {
        classpath 'org.ajoberstar:gradle-git:0.12.0'
    }
}

task wrapper(type: Wrapper) {
    gradleVersion = '2.1'
}

jar {
    ext.repo = Grgit.open(project.file('.'))
    ext.lastTag = repo.tag.list().last().getName()
    ext.currentVersion = "${lastTag}-${repo.head().abbreviatedId}"

    version = currentVersion

    from(projectDir) {
        include 'installed.txt'
        include 'IntelliJ IDEA Global Settings'
        include 'colors/**'
        include 'options/**'
    }
}